<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Dashboard Analisis Program IUP</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1, h2, h3 { text-align: center; }
        table { border-collapse: collapse; margin: 0 auto; width: 90%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #eee; }
        .section { margin-bottom: 50px; }
        select { padding: 5px; font-size: 1rem; }
        form { text-align: center; margin-bottom: 20px; }
    </style>
</head>
<body>

<h1>Dashboard Analisis Program IUP di PTN</h1>

<div class="section">
    <h2>Jumlah PTN dan Jurusan</h2>
    <p style="text-align:center;">
        Jumlah PTN: <b>{{ jumlah_ptn }}</b><br/>
        Jumlah Jurusan per PTN:<br/>
        <ul>
            {% for ptn, jml in jurusan_per_ptn.items() %}
                <li><b>{{ ptn }}</b>: {{ jml }} jurusan</li>
            {% endfor %}
        </ul>
    </p>
</div>

<div class="section">
    <h2>Distribusi Daya Tampung per Prodi</h2>
    <form method="get" action="/">
        <label for="ptn_daya">Pilih PTN:</label>
        <select id="ptn_daya" name="ptn_daya" onchange="this.form.submit()">
            {% for ptn in ptn_list %}
                <option value="{{ ptn }}" {% if ptn == selected_ptn_daya %}selected{% endif %}>{{ ptn }}</option>
            {% endfor %}
        </select>
        <!-- Passing other params to keep selections -->
        <input type="hidden" name="ptn_ukt" value="{{ selected_ptn_ukt }}">
        <input type="hidden" name="ptn_detail" value="{{ selected_ptn_detail }}">
    </form>
    <div>{{ chart_daya|safe }}</div>
</div>

<div class="section">
    <h2>Distribusi UKT per Prodi</h2>
    <form method="get" action="/">
        <label for="ptn_ukt">Pilih PTN:</label>
        <select id="ptn_ukt" name="ptn_ukt" onchange="this.form.submit()">
            {% for ptn in ptn_list %}
                <option value="{{ ptn }}" {% if ptn == selected_ptn_ukt %}selected{% endif %}>{{ ptn }}</option>
            {% endfor %}
        </select>
        <!-- Keep other selections -->
        <input type="hidden" name="ptn_daya" value="{{ selected_ptn_daya }}">
        <input type="hidden" name="ptn_detail" value="{{ selected_ptn_detail }}">
    </form>
    <div>{{ chart_ukt|safe }}</div>
</div>

<div class="section">
    <h2>Data Detail Jurusan, Daya Tampung & UKT</h2>
    <form method="get" action="/">
        <label for="ptn_detail">Pilih PTN:</label>
        <select id="ptn_detail" name="ptn_detail" onchange="this.form.submit()">
            {% for ptn in ptn_list %}
                <option value="{{ ptn }}" {% if ptn == selected_ptn_detail %}selected{% endif %}>{{ ptn }}</option>
            {% endfor %}
        </select>
        <!-- Keep others -->
        <input type="hidden" name="ptn_daya" value="{{ selected_ptn_daya }}">
        <input type="hidden" name="ptn_ukt" value="{{ selected_ptn_ukt }}">
    </form>

    <table>
        <thead>
            <tr>
                <th>Jurusan</th>
                <th>Daya Tampung</th>
                <th>UKT (Rupiah)</th>
            </tr>
        </thead>
        <tbody>
            {% for row in filtered %}
            <tr>
                <td>{{ row['JURUSAN'] }}</td>
                <td>{{ row['DAYA TAMPUNG'] }}</td>
                <td>{{ row['UKT_RUPIAH'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="section">
    <h2>7 Prodi dengan UKT Termahal dari PTN Berbeda</h2>
    <div>{{ chart_ukt_termahal|safe }}</div>
</div>

<div class="section">
    <h2>7 Prodi dengan Daya Tampung Terbanyak dari PTN</h2>
    <div>{{ chart_daya_terbanyak|safe }}</div>
</div>

<div class="section">
    <h2>7 Prodi dengan UKT Termurah dari PTN</h2>
    <div>{{ chart_ukt_termurah|safe }}</div>
</div>

<div class="section">
    <h2>7 Prodi dengan Daya Tampung Terkecil dari PTN</h2>
    <div>{{ chart_dayamin|safe }}</div>
</div>

<div class="section">
    <h2>10 Jurusan Terpopuler</h2>
    <div>{{ chart_popular|safe }}</div>
</div>

</body>
</html>
